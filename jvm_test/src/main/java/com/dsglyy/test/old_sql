CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_SUPPLIER (
	supplier_id STRING COMMENT '供应商ID',
	father_id STRING COMMENT '父供应商ID',
	supplier_name STRING COMMENT '供应商名称',
	district_id STRING COMMENT '行政区域ID',
	supplier_type STRING COMMENT '供应商类型',
	address STRING COMMENT '地址',
	tel STRING COMMENT '电话',
	fax STRING COMMENT '传真',
	site STRING COMMENT '网站',
	zip STRING COMMENT '邮编',
	legal_rep STRING COMMENT '法定代表人',
	permit STRING COMMENT '旅行社许可证',
	api_flag STRING COMMENT '是否对接',
	cancel_flag STRING COMMENT '是否删除',
	supplier_tel STRING COMMENT '',
	notintime_flag STRING COMMENT '不可及时通关',
	qualify_type STRING COMMENT '供应商资质范围(存储枚举Code，用逗号分割多个资质)',
	subsidiary_flag STRING COMMENT '是否为子公司',
	update_time STRING COMMENT '修改时间[待核实-刘源远]',
	supplier_level_type STRING COMMENT '供应商层级类型',
	supplier_purchase_type STRING COMMENT '',
	sub_company_id STRING COMMENT '公司id[待核实-刘源远]',
	cancel_reason STRING COMMENT '无效原因',
	supplier_categorys STRING COMMENT '供应商合作品类 ',
	supplier_grade STRING COMMENT '供应商合作等级',
	lock_status STRING COMMENT '供应商锁定状态',
	supplier_logo STRING COMMENT '供应商LOGO URL链接',
	supplier_seal STRING COMMENT '供应商公章 URL链接'
) COMMENT '供应商' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_SUPPLIER';

CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_ORDER_RELATION (
	ID STRING COMMENT '自增主键',
	supplier_id STRING COMMENT '供应商编号',
	supp_order_id STRING COMMENT '供应商的订单id',
	vst_order_id STRING COMMENT '驴妈妈的订单id',
	vst_order_item_id STRING COMMENT '驴妈妈的子订单id',
	supp_order_status STRING COMMENT '供应商订单状态',
	visit_date STRING COMMENT '入住开始时间',
	leave_date STRING COMMENT '入住结束时间',
	create_time STRING COMMENT '创建时间',
	update_time STRING COMMENT '更新时间',
	isvalid STRING COMMENT '0或空-有效，1-无效',
	serialno STRING COMMENT '流水号'
) COMMENT '供应商订单和驴妈妈订单关系表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_ORDER_RELATION';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_ORDER (
	ID STRING COMMENT '自增主键',
	supplier_id STRING COMMENT '供应商ID',
	supp_order_id STRING COMMENT '供应商给的 order_id',
	order_id STRING COMMENT 'Ord_order_id',
	order_item_id STRING COMMENT 'Order_item_id',
	create_date STRING COMMENT '订单创建时间',
	status STRING COMMENT '供应商订单状态',
	parent_supp_order_id STRING COMMENT '供应商父订单',
	update_date STRING COMMENT '更新时间',
	start_date STRING COMMENT '游玩开始时间',
	end_date STRING COMMENT '游玩结束时间',
	valid STRING COMMENT '有效区分0或空有效，1无效'
) COMMENT '供应商订单表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_ORDER';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_WIFI_INTRODUCTION (
	goods_id STRING COMMENT '驴妈妈产品ID[待核实-刘源远]',
	charge_explain STRING COMMENT '收费说明',
	desposit_explain STRING COMMENT '押金说明',
	refund_rule STRING COMMENT '退改规则',
	goods_configure STRING COMMENT '商品配置',
	use_explain STRING COMMENT '使用说明'
) COMMENT '商品介绍' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_WIFI_INTRODUCTION';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_SHIP_BASE (
	base_id STRING COMMENT '主键ID',
	product_id STRING COMMENT '产品id',
	supplier_id STRING COMMENT '供应商ID',
	manager_id STRING COMMENT '产品经理ID',
	package_flag STRING COMMENT '是否仅组合销售',
	filiale STRING COMMENT '分公司',
	bu STRING COMMENT '所属BU',
	attribution_id STRING COMMENT '归属地',
	pay_target STRING COMMENT '支付对象',
	fax_flag STRING COMMENT '是否传真',
	fax_remark STRING COMMENT '传真备注',
	fax_rule_id STRING COMMENT '传真规则ID',
	contract_id STRING COMMENT '合同ID',
	max_quantity DECIMAL (11) COMMENT '最大起订量',
	min_quantity DECIMAL (11) COMMENT '最小起订量',
	goods_type STRING COMMENT '商品类型',
	express_type STRING COMMENT '寄件方',
	company_type STRING COMMENT '公司主体',
	content_manager_id STRING COMMENT '内容维护人员',
	notice_type STRING COMMENT '通知方式',
	post_free_flag STRING COMMENT '是否免运费',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '产品商品基础信息' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_SHIP_BASE';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_SHARE_TOTAL_STOCK (
	share_total_stock_id STRING COMMENT '共享总库存ID',
	share_total_stock_group_id STRING COMMENT '共享总库存组ID',
	begin_date STRING COMMENT '开始时间',
	end_date STRING COMMENT '结束时间',
	init_count DECIMAL (11) COMMENT '设置的库存量',
	current_count DECIMAL (11) COMMENT '剩余库存量'
) COMMENT '附赠商品共享总库存组[待核实-刘源远]' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_SHARE_TOTAL_STOCK';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_SHARE_DAY_LIMIT (
	share_day_limit_id STRING COMMENT '共享日限制ID',
	limit_group_id STRING COMMENT '共享日限制组ID',
	spec_date STRING COMMENT '有效日期',
	init_count DECIMAL (11) COMMENT '初始日限制',
	current_count DECIMAL (11) COMMENT '当前日限制'
) COMMENT '附赠商品共享期限[待核实-刘源远]' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_SHARE_DAY_LIMIT';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_LINE_TIME_PRICE (
	time_price_id STRING COMMENT '时间价格ID',
	supp_goods_id STRING COMMENT '供应商商品ID',
	supplier_id STRING COMMENT '供应商ID',
	spec_date STRING COMMENT '时间',
	stock_type STRING COMMENT '库存类型',
	stock DECIMAL (11) COMMENT '日库存',
	total_stock DECIMAL (11) COMMENT '日总库存',
	oversell_flag STRING COMMENT '是否可超卖',
	onsale_flag STRING COMMENT 'Y可售N禁售',
	audit_settlement_price DECIMAL (11) COMMENT '成人结算价格',
	audit_price DECIMAL (11) COMMENT '成人售价',
	child_settlement_price DECIMAL (11) COMMENT '儿童结算价格',
	child_price DECIMAL (11) COMMENT '儿童售价',
	grap_settlement_price DECIMAL (11) COMMENT '房差结算价',
	gap_price DECIMAL (11) COMMENT '房差销售价',
	ahead_book_time DECIMAL (11) COMMENT '提前预订时间',
	book_limit_type STRING COMMENT '是否强制预授权',
	init_stock DECIMAL (11) COMMENT '初始库存'
) COMMENT '线路商品时间价格表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_LINE_TIME_PRICE';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_GROUP_STOCK (
	stock_id STRING COMMENT '商品组库存ID',
	GROUP_ID STRING COMMENT '商品组ID',
	spec_date STRING COMMENT '时间',
	stock DECIMAL (11) COMMENT '日库存',
	total_stock DECIMAL (11) COMMENT '日总库存'
) COMMENT '商品组库存' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_GROUP_STOCK';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_GROUP (
	GROUP_ID STRING COMMENT '商品组ID',
	supplier_id STRING COMMENT '供应商ID',
	group_name STRING COMMENT '组名'
) COMMENT '商品组(共享或共用)' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_GROUP';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_GROSS_MARGIN (
	supp_goods_gross_margin_id STRING COMMENT '主键',
	category_id STRING COMMENT '品类',
	bu STRING COMMENT '所属BU',
	filiale STRING COMMENT '所属分公司',
	gross_margin_type STRING COMMENT '毛利率类型',
	gross_margin DECIMAL (11) COMMENT '毛利率',
	creator DECIMAL (11) COMMENT '创建者',
	create_time STRING COMMENT '创建时间'
) COMMENT '毛利率' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_GROSS_MARGIN';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_DESC_CLOB (
	supp_goods_desc_json_id STRING COMMENT '商品描述ID',
	description_content STRING COMMENT '存储内容'
) COMMENT 'goods 描述[待核实-刘源远]' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_DESC_CLOB';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_DESC_JSON (
	supp_goods_desc_json_id STRING COMMENT '主键ID',
	category_id STRING COMMENT '品类ID',
	supp_goods_id STRING COMMENT '商品ID',
	supp_goods_type STRING COMMENT '商品类型',
	content_type STRING COMMENT '内容类型',
	CONTENT STRING COMMENT '存储内容',
	clob_flag STRING COMMENT '是否使用大字段标记（使用：Y 不使用：N）'
) COMMENT '附赠 goods 描述 json [待核实-刘源远]' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_DESC_JSON';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_SUPP_GOODS_DESC (
	desc_id STRING COMMENT '商品描述ID',
	supp_goods_id STRING COMMENT '供应商商品ID',
	price_includes STRING COMMENT '费用包含',
	change_time STRING COMMENT '取票时间',
	change_address STRING COMMENT '取票地点',
	enter_style STRING COMMENT '入园方式',
	limit_flag STRING COMMENT '是否限制入园',
	limit_time STRING COMMENT '入园限制时间',
	height STRING COMMENT '身高',
	age STRING COMMENT '年龄',
	region STRING COMMENT '地域',
	max_quantity STRING COMMENT '最大限购',
	express STRING COMMENT '快递',
	entity_ticket STRING COMMENT '实体票',
	others STRING COMMENT '其他',
	need_ticket STRING COMMENT '是否需要取票',
	change_limit_flag STRING COMMENT '是否限制取票时间',
	visit_address STRING COMMENT '入园地点',
	type_desc STRING COMMENT '票种说明',
	pass_flag STRING COMMENT '是否限制通关',
	pass_limit_time STRING COMMENT '限制通关时间',
	describe STRING COMMENT '描述',
	map_img_url STRING COMMENT '取票地址地图图片URL',
	update_time STRING COMMENT '更新时间[待核实-刘源远]',
	costs_not_included STRING COMMENT '费用不包含'
) COMMENT '商品描述' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_SUPP_GOODS_DESC';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_RES_PRECONTROL_PAYMENT (
	payment_id STRING COMMENT '付款流水ID',
	precontrol_policy_id STRING COMMENT '资源预控策略ID',
	amount DECIMAL (11) COMMENT '付款金额(分)',
	pay_person STRING COMMENT '付款人',
	pay_date STRING COMMENT '付款日期',
	operator_id STRING COMMENT '操作人ID',
	memo STRING COMMENT '备注',
	creat_time STRING COMMENT '创建时间',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '资源预控付款流水表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_RES_PRECONTROL_PAYMENT';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_REFUND_BATCH_DETAIL (
	ID STRING COMMENT '主键 lvmama_ver.seq_refund_batch_detail_id',
	refund_item_batch DECIMAL (11) COMMENT '子订单退款批次id(ord_refund_item_batch)',
	order_item_id STRING COMMENT '子订单号',
	item_audit_status STRING COMMENT '子订单审核状态',
	memo STRING COMMENT '备注',
	create_time STRING COMMENT '操作时间',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '子订单退款批次明细表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_REFUND_BATCH_DETAIL';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_REFUND_BATCH (
	ID STRING COMMENT '主键lvmama_ver.seq_refund_batch_id',
	order_id STRING COMMENT '订单ID',
	order_item_id STRING COMMENT '子订单ID',
	refund_quantity DECIMAL (11) COMMENT '退订份数',
	audit_status STRING COMMENT '批次审核状态',
	item_audit_status STRING COMMENT '本批次子订单审核状态',
	refund_apply_id STRING COMMENT '退款申请id(ord_refund_apply的主键)',
	memo STRING COMMENT '备注',
	OPERATOR STRING COMMENT '操作账号',
	create_time STRING COMMENT '发起时间',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '子订单退款批次表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_REFUND_BATCH';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PROM_RESULT (
	prom_result_id STRING COMMENT '主键',
	prom_promotion_id STRING COMMENT '主键',
	result_type STRING COMMENT '促销方案类型',
	result_second_type STRING COMMENT '促销方案二级类型(对应符合优惠的类型)',
	amount_type STRING COMMENT '优惠金额类型(固定金额|百分比）',
	fixed_amount DECIMAL (11) COMMENT '固定金额',
	rate_amount DECIMAL (11) COMMENT '比例金额(例20%,录入20)',
	price_type STRING COMMENT '降价优惠方案类型',
	hotel_nights DECIMAL (11) COMMENT '酒店相关的天的数量',
	liner_sec_fixed_amount DECIMAL (28, 0) COMMENT '油轮第三、四人折扣金额',
	liner_sec_rate_amount DECIMAL (28, 0) COMMENT '油轮第三、四人折扣比例(例:20%,录入20)',
	liner_thi_fixed_amount DECIMAL (28, 0) COMMENT '油轮第三、四人儿童折扣金额',
	liner_thi_rate_amount DECIMAL (28, 0) COMMENT '油轮第三、四人儿童折扣比例(例:20%,录入20)',
	room_type STRING COMMENT '房间类型[待核实-刘源远]',
	add_each DECIMAL (28, 0) COMMENT '每增加份数',
	CHILD STRING COMMENT '类别',
	child_fixeda_mount STRING COMMENT '类别值',
	child_rate_amount STRING COMMENT '类别值百分',
	rule_calc_type STRING COMMENT '规则计算方式',
	lowest_price DECIMAL (11) COMMENT '产品起价[待核实-刘源远]',
	highest_price DECIMAL (11) COMMENT '产品封顶价[待核实-刘源远]'
) COMMENT '促销结果' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PROM_RESULT';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PROM_PROMOTION (
	prom_promotion_id STRING COMMENT '主键',
	title STRING COMMENT '标题,(展示给下单人看到的标题)',
	code STRING COMMENT 'code信息',
	begin_time STRING COMMENT '开始时间',
	end_time STRING COMMENT '结束时间',
	time_type STRING COMMENT '可使用时间类型（入住日期|在店日期）',
	EXCLUSIVE STRING COMMENT '排他属性(Y:排他,N:不排他)',
	valid STRING COMMENT '是否有效(Y:有效,N:无效)',
	create_time STRING COMMENT '创建时间',
	rule_type STRING COMMENT '优惠规则',
	rule_value STRING COMMENT '规则值',
	price_type STRING COMMENT '针对价格类型',
	favorable_target STRING COMMENT 'PROM_GOODS|PROM_TARGET',
	fee_channel_code DECIMAL (28, 0) COMMENT '发布渠道',
	promition_type STRING COMMENT '',
	categroy_id STRING COMMENT '品类ID[待核实-刘源远]',
	channel_order STRING COMMENT '',
	instrs STRING COMMENT '',
	start_visit_time STRING COMMENT '旅游开始时间[待核实-刘源远]',
	end_visit_time STRING COMMENT '旅游结束[待核实-刘源远]',
	branchs STRING COMMENT '',
	operator_name STRING COMMENT '创建人',
	assume_dept STRING COMMENT '费用承担部门',
	prom_amount DECIMAL (28, 0) COMMENT '活动费用总额',
	used_amount DECIMAL (28, 0) COMMENT '活动已用金额',
	update_time STRING COMMENT '更新时间',
	assume_dept2 STRING COMMENT '费用承担部门2',
	assume_dept3 STRING COMMENT '费用承担部门3',
	assume_dept4 STRING COMMENT '费用承担部门4',
	assume_dept5 STRING COMMENT '费用承担部门5',
	assume_percent STRING COMMENT '费用百分比',
	assume_percent2 STRING COMMENT '费用百分比2',
	assume_percent3 STRING COMMENT '费用百分比3',
	assume_percent4 STRING COMMENT '费用百分比4',
	assume_percent5 STRING COMMENT '费用百分比5',
	show_time STRING COMMENT '促销提前展示时间',
	available_day DECIMAL (5) COMMENT '促销可用天',
	available_travel_day DECIMAL (5) COMMENT '游玩可用天',
	stick STRING COMMENT '是否置顶',
	accumulation STRING COMMENT '可叠加',
	maximum DECIMAL (11) COMMENT '单笔最高限制额度',
	usernumber DECIMAL (11) COMMENT '单用户可享次数',
	usednmuber DECIMAL (11) COMMENT '已经使用',
	ordernumber DECIMAL (11) COMMENT '可享促销总订单数',
	couponexclusion STRING COMMENT '是否与优惠券互斥'
) COMMENT '促销' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PROM_PROMOTION';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PROM_GOODS (
	prom_goods_id STRING COMMENT '主键',
	supp_goods_id STRING COMMENT '供应商商品ID',
	prom_promotion_id STRING COMMENT '主键',
	object_type STRING COMMENT '类型（产品/商品）[待核实-刘源远]',
	update_time STRING COMMENT '更新时间',
	create_time STRING COMMENT '创建时间'
) COMMENT '促销商品' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PROM_GOODS';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PROD_TAG (
	re_id STRING COMMENT '关联ID',
	object_type STRING COMMENT '类型（产品/商品）',
	object_id STRING COMMENT '产品/商品ID',
	tag_id STRING COMMENT '标签ID',
	start_time STRING COMMENT '开始时间',
	end_time STRING COMMENT '结束时间',
	update_time STRING COMMENT '更新时间[待核实-刘源远]',
	display_type DECIMAL (11) COMMENT '显示位置(0.无 1.pc,2.无线端 3.pc和无线端)'
) COMMENT '产品/商品标签' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PROD_TAG';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PROD_SUBJECT (
	re_id STRING COMMENT '关联ID',
	product_id STRING COMMENT '产品ID',
	subject_id STRING COMMENT '主题ID',
	seq DECIMAL (5) COMMENT '排序值',
	update_time STRING COMMENT '更新时间[待核实-刘源远]',
	add_flag STRING COMMENT '新老数据表示'
) COMMENT '产品主题' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PROD_SUBJECT';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PROD_PRODUCT_BRANCH_PROP_BLOB (
	product_branch_prop_id STRING COMMENT '产品规格属性ID',
	prop_value STRING COMMENT '属性值',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '标准产品属性大字段属性值表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PROD_PRODUCT_BRANCH_PROP_BLOB';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PROD_PRODUCT_BRANCH_PROP (
	product_branch_prop_id STRING COMMENT '商品属性ID',
	prop_id STRING COMMENT '规格属性ID',
	product_branch_id STRING COMMENT '商品ID',
	prod_value STRING COMMENT '商品属性值',
	add_value STRING COMMENT '属性值补充内容',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '产品规格属性' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PROD_PRODUCT_BRANCH_PROP';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PROD_PRODUCT_BRANCH (
	product_branch_id STRING COMMENT '商品ID',
	branch_id STRING COMMENT '规格定义ID',
	product_id STRING COMMENT '产品ID',
	branch_name STRING COMMENT '商品名',
	cancel_flag STRING COMMENT '是否有效',
	recommend_level DECIMAL (11) COMMENT '推荐级别',
	sale_flag STRING COMMENT '是否可售',
	max_visitor DECIMAL (11) COMMENT '最多接待人数',
	sensitive_flag STRING COMMENT '是否有敏感词',
	update_time STRING COMMENT '更新时间[待核实-刘源远]',
	add_branch_name STRING COMMENT '补充名称',
	max_child_visitor DECIMAL (11) COMMENT '',
	departure_station STRING COMMENT '出发车站',
	arrival_station STRING COMMENT '到达车站'
) COMMENT '产品规格' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PROD_PRODUCT_BRANCH';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PROD_PRODUCT (
	product_id STRING COMMENT '产品ID',
	category_id STRING COMMENT '品类ID',
	product_name STRING COMMENT '产品名',
	cancel_flag STRING COMMENT '是否有效',
	recommend_level DECIMAL (11) COMMENT '推荐级别',
	sale_flag STRING COMMENT '是否可售',
	district_id STRING COMMENT '行政区域',
	manager_id STRING COMMENT '产品经理',
	filiale STRING COMMENT '分公司',
	url_id STRING COMMENT 'url拼音',
	create_time STRING COMMENT '创建时间',
	create_user STRING COMMENT '创建人',
	update_time STRING COMMENT '修改时间',
	update_user STRING COMMENT '修改人',
	product_type STRING COMMENT '产品类型：国内-短线、国内-长线、出境/港澳台，存放枚举Code',
	package_type STRING COMMENT '打包类型:自主打包/供应商打包/无',
	audit_status STRING COMMENT '审核状态',
	sensitive_flag STRING COMMENT '是否有敏感词',
	supp_product_name STRING COMMENT '供应商产品名',
	SOURCE STRING COMMENT '产品来源（EBK/BACK）',
	bu STRING COMMENT 'BU',
	attribution_id STRING COMMENT '归属地区ID',
	company_type STRING COMMENT '公司主体',
	muilt_departure_flag STRING COMMENT '多出发地标记字段，是：Y 否：N',
	abandon_flag STRING COMMENT '废弃标识；Y:废弃；N:正常；默认为正常(N)',
	manager_id_perm STRING COMMENT '产品权限',
	model_version DECIMAL (2, 1) COMMENT '版本标记字段，1.0,2.0 ...',
	sub_category_id STRING COMMENT '子品类ID',
	traveller_delay_flag STRING COMMENT 'Y游玩人后置',
	ebk_supplier_group_id STRING COMMENT 'EBK用户所属供应商组ID',
	prefix_name STRING COMMENT '产品名称前缀',
	wifi_line_type STRING COMMENT 'WIFI/电话卡使用,因PRODUCT_TYPE被占用,故加此字段,取值:INNERLINE/FOREIGNLINE',
	product_name_struct STRING COMMENT '',
	product_origin STRING COMMENT '',
	product_tour_type STRING COMMENT '',
	product_grade STRING COMMENT '产品等级',
	min_order_quantity DECIMAL (3) COMMENT '最小起订份数（成人）',
	operation_category STRING COMMENT '运营类别',
	is_muilt_departure STRING COMMENT '供应商打包是否多出发地',
	equipments STRING COMMENT '产品设施'
) COMMENT '标准产品' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PROD_PRODUCT';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PRICE_PLAN_RELATION (
	rela_id STRING COMMENT '主键ID',
	price_plan_id STRING COMMENT '主键ID',
	supp_goods_id STRING COMMENT '商品ID(酒套餐商品ID)',
	line_route_id STRING COMMENT '行程ID'
) COMMENT '价格关联表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PRICE_PLAN_RELATION';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PRICE_PLAN (
	price_plan_id STRING COMMENT '主键ID',
	plan_name STRING COMMENT '计划名称',
	stock_table_name STRING COMMENT '库存来源表的表名'
) COMMENT '价格计划表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PRICE_PLAN';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_VER_PRESALE_STAMP_TIME_PRICE (
	ID STRING COMMENT '',
	category_id STRING COMMENT '类品ID',
	goods_id STRING COMMENT '商品ID',
	product_id STRING COMMENT '产品ID',
	`VALUE` DECIMAL (11) COMMENT '价格',
	apply_date STRING COMMENT '可用日期',
	price_classification_code STRING COMMENT '',
	is_ban_sell STRING COMMENT '是否禁售',
	is_presale STRING COMMENT '是否预售'
) COMMENT '预售劵时间价格表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_VER_PRESALE_STAMP_TIME_PRICE';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_TICKET_REFUND_SERIAL (
	ticket_refund_serial_id STRING COMMENT '主键',
	order_id STRING COMMENT '订单ID',
	order_item_id STRING COMMENT '子订单ID',
	refundment_id STRING COMMENT '退款单号',
	quantity DECIMAL (11) COMMENT '退款份数',
	TYPE STRING COMMENT '操作类型',
	create_time STRING COMMENT '发起时间'
) COMMENT '子订单退款流水表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_TICKET_REFUND_SERIAL';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_STATUS_GROUP (
	status_group_id STRING COMMENT '主键',
	fileds STRING COMMENT 'FIELD:VALUE,',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单状态组' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_STATUS_GROUP';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_SETTLEMENT_PRICE_RECORD (
	record_id STRING COMMENT '主键',
	order_item_id STRING COMMENT '订单子子项ID',
	price_type STRING COMMENT '修改的价格类型',
	old_actual_settlement_price DECIMAL (11) COMMENT '修改之前的实际结算单价',
	old_total_settlement_price DECIMAL (11) COMMENT '修改之前的实际结算总价',
	new_actual_settlement_price DECIMAL (11) COMMENT '修改之后的实际结算单价',
	new_total_settlement_price DECIMAL (11) COMMENT '修改之后的实际结算总价',
	change_type STRING COMMENT '修改类型 (修改结算单价/修改结算总价)',
	change_result STRING COMMENT '修改结果 (调低/调高)',
	reason STRING COMMENT '修改原因',
	OPERATOR STRING COMMENT '操作人',
	create_time STRING COMMENT '创建时间',
	remark STRING COMMENT '修改结算价备注',
	approve_remark STRING COMMENT '审核备注',
	status STRING COMMENT '状态',
	update_time STRING COMMENT '更新时间',
	operator_approve STRING COMMENT '操作人',
	order_id STRING COMMENT '订单ID',
	supp_goods_id STRING COMMENT '商品ID',
	is_approve STRING COMMENT '是否审核过（Y,N）',
	visit_time STRING COMMENT '游玩日期|入住日期[待核实-刘源远]',
	old_budget_unit_settle_price DECIMAL (11) COMMENT '修改之前的买断单价',
	old_budget_total_settle_price DECIMAL (11) COMMENT '修改之前的买断总价',
	new_budget_unit_settle_price DECIMAL (11) COMMENT '修改之后的买断单价',
	new_budget_total_settle_price DECIMAL (11) COMMENT '修改之后的买断总价'
) COMMENT '订单结算价修改记录' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_SETTLEMENT_PRICE_RECORD';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_RESPONSIBLE (
	responsible_id STRING COMMENT '主键',
	object_id STRING COMMENT '对象ID',
	object_type STRING COMMENT '对象类型',
	operator_name STRING COMMENT '操作人',
	create_time STRING COMMENT '创建时间',
	org_id STRING COMMENT '组织部门ID[待核实-刘源远]',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单负责人' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_RESPONSIBLE';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_REFUND_SALE_RECORD (
	refund_sale_record_id STRING COMMENT '主键',
	order_id STRING COMMENT '订单ID',
	order_item_id STRING COMMENT '子订单ID',
	category_id STRING COMMENT '品类ID',
	total_amount DECIMAL (11) COMMENT '子订单总价',
	CONTENT STRING COMMENT '附加内容json格式',
	deduct_amount DECIMAL (11) COMMENT '扣款金额',
	refund_money DECIMAL (11) COMMENT '退款金额',
	status STRING COMMENT '状态(0：未处理，1：售后单，2：售后单&退款单)',
	create_time STRING COMMENT '创建时间',
	update_time STRING COMMENT '更新时间',
	apply_time STRING COMMENT '申请时间',
	VERSION DECIMAL (11) COMMENT '版本'
) COMMENT '订单售后退款记录' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_REFUND_SALE_RECORD';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_REFUND_ITEM (
	ID STRING COMMENT '主键ID',
	order_id STRING COMMENT '订单ID[待核实-刘源远]',
	order_item_id STRING COMMENT '订单子子项编号[待核实-刘源远]',
	refund_types STRING COMMENT '退款类型',
	quantity DECIMAL (11) COMMENT '退款份数',
	status STRING COMMENT '状态',
	valid_from STRING COMMENT '起始日期',
	valid_thru STRING COMMENT '终止日期',
	create_time STRING COMMENT '创建时间[待核实-刘源远]',
	update_time STRING COMMENT '更新时间[待核实-刘源远]',
	refund_price DECIMAL (11) COMMENT '退款金额'
) COMMENT '订单退款明细' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_REFUND_ITEM';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_PROMOTION (
	order_item_id STRING COMMENT '订单商品ID',
	prom_promotion_id STRING COMMENT '主键',
	ord_promotion_id STRING COMMENT '主键',
	prom_title STRING COMMENT '促销名称',
	code STRING COMMENT 'CODE信息',
	price_type STRING COMMENT '针对价格类型',
	object_type STRING COMMENT '对象类型（ORDER_ITEM|ORDER_PACK）',
	favorable_amount DECIMAL (28, 0) COMMENT '优惠金额',
	occupy_amount_flag STRING COMMENT '是否扣减促销额度',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单促销信息' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_PROMOTION';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_PAY_PROMOTION (
	ord_pay_promotion_id STRING COMMENT 'ID',
	order_id STRING COMMENT '订单商品id',
	pay_promotion_id STRING COMMENT '促销id',
	prom_title STRING COMMENT '促销名称',
	favorable_amount DECIMAL (11) COMMENT '优惠金额',
	create_time STRING COMMENT '创建时间[待核实-刘源远]',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单促销信息' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_PAY_PROMOTION';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_PAYMENT_INFO (
	order_id STRING COMMENT '订单ID订单ID',
	payment_id STRING COMMENT '付款流水ID[待核实-刘源远]',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单和付款信息关联表[待核实-刘源远]' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_PAYMENT_INFO';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_TRACKING (
	tracking_id STRING COMMENT '编号',
	order_id STRING COMMENT '订单ID',
	order_status STRING COMMENT '订单状态',
	category_id STRING COMMENT '品类',
	additional_content STRING COMMENT '附件信息（返现金额）',
	change_status_time STRING COMMENT '状态改变时间',
	create_time STRING COMMENT '创建时间',
	update_time STRING COMMENT '更新时间'
) COMMENT '订单状态跟踪[待核实-刘源远]' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_TRACKING';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_STOCK (
	order_stock_id STRING COMMENT '主键',
	order_item_id STRING COMMENT '订单商品ID',
	object_id STRING COMMENT '对象ID[待核实-刘源远]',
	object_type STRING COMMENT 'ord_order_item|ord_order_hotel_time_rate',
	visit_time STRING COMMENT '日期',
	quantity DECIMAL (11) COMMENT '数量(减少库存时允许该值小于0)',
	inventory STRING COMMENT '是否有库存下单',
	need_resource_confirm STRING COMMENT '是否需要资源审核',
	resource_status STRING COMMENT '资源审核状态',
	share_total_stock_id STRING COMMENT '共享总库存ID',
	share_day_limit_id STRING COMMENT '共享日限制ID',
	init_inventory STRING COMMENT '是否有库存下单，初始化存入后不修改',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '库存记录，如果订单发生数量变更时记录变更记录' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_STOCK';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_STATUS (
	ord_status_id STRING COMMENT '状态码ID',
	order_id STRING COMMENT '订单ID',
	order_item_id STRING COMMENT '订单子项',
	status DECIMAL (11) COMMENT '下单状态(1,成功 2,失败 3,处理中)',
	error_code STRING COMMENT '错误编码',
	error_msg STRING COMMENT '下单失败消息',
	create_time STRING COMMENT '创建时间',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '下单状态码' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_STATUS';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_SHARED_STOCK (
	order_shared_stock_id STRING COMMENT '主键',
	order_item_id STRING COMMENT '订单商品ID',
	object_id STRING COMMENT '对象ID[待核实-刘源远]',
	object_type STRING COMMENT 'ord_order_item|ord_order_hotel_time_rate',
	goods_id STRING COMMENT '商品ID',
	GROUP_ID STRING COMMENT '共享组ID',
	visit_time STRING COMMENT '日期',
	quantity DECIMAL (11) COMMENT '数量(减少库存时允许该值小于0)',
	inventory STRING COMMENT '是否有库存下单',
	need_resource_confirm STRING COMMENT '是否需要资源审核',
	resource_status STRING COMMENT '资源审核状态',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '库存记录，如果订单发生数量变更时记录变更记录' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_SHARED_STOCK';

#================================工作流================================
CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_REMARK_LOG (
	log_id STRING COMMENT '备注日志id',
	order_id STRING COMMENT '订单id',
	CONTENT STRING COMMENT '备注内容',
	created_time STRING COMMENT '创建时间',
	created_user STRING COMMENT '创建人',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单详细页面备注记录' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_REMARK_LOG';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_MARK (
	ID STRING COMMENT '主键ID',
	order_id STRING COMMENT '订单ID',
	mark_flag DECIMAL (1) COMMENT '订单验颜色标记(1：已搬单；2：未搬单)',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单标记' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_MARK';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_LOSC (
	order_losc_id STRING COMMENT 'pk',
	order_id STRING COMMENT '订单ID',
	losc_id STRING COMMENT '',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单来源跟踪记录' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_LOSC';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_COST_SHARING_ITEM (
	ID STRING COMMENT '主键ID[待核实-刘源远]',
	order_id STRING COMMENT '订单ID[待核实-刘源远]',
	order_item_id STRING COMMENT '子订单id[待核实-刘源远]',
	cost_category STRING COMMENT '费用类别',
	cost_type STRING COMMENT '费用类型',
	amount DECIMAL (11) COMMENT '金额',
	purpose STRING COMMENT '用途',
	status STRING COMMENT '',
	create_date STRING COMMENT '创建时间[待核实-刘源远]',
	update_date STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '子订单费用分摊' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_COST_SHARING_ITEM';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_COMMISSION (
	ord_commission_id STRING COMMENT '主键Id',
	order_id STRING COMMENT '主订单Id',
	order_item_id STRING COMMENT '子订单Id',
	commission_targett STRING COMMENT '设置对象(枚举值，参照组织结构枚举值)',
	commission_target_id STRING COMMENT '设置对象Id（分别对用子公司Id、分社Id和门店Id）',
	commission_type STRING COMMENT '佣金类型(枚举值 佣金：PROFITS）',
	commission_proportion DECIMAL (11) COMMENT '佣金比例( 单位 比例：%   金额：分))',
	commission_amount DECIMAL (11) COMMENT '佣金金额（单位：分）（注：门店专享优惠前）',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '门店下单佣金' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_COMMISSION';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_AMOUNT_ITEM (
	order_amount_item_id STRING COMMENT '主键',
	order_id STRING COMMENT '订单ID',
	item_name STRING COMMENT '名称',
	item_amount DECIMAL (11) COMMENT '金额',
	order_amount_type STRING COMMENT '金额类型',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单金额变换表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_AMOUNT_ITEM';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_MUL_PRICE_RATE (
	ord_mul_price_rate_id STRING COMMENT '主键ID',
	order_item_id STRING COMMENT '订单商品ID',
	price DECIMAL (11) COMMENT '价格',
	quantity DECIMAL (11) COMMENT '数量',
	price_type STRING COMMENT '价格类型(第一二人价格|第三四人价格|第三四人儿童价格)',
	amount_type STRING COMMENT '金额类型（PRICE|SETTLEMENT|MARKET)',
	update_time STRING COMMENT '修改时间'
) COMMENT '订单子项价格记录表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_MUL_PRICE_RATE';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ITEM_CONTRACT_RELATION (
	ID STRING COMMENT '主键',
	order_item_id STRING COMMENT '子订单ID',
	ord_contract_id STRING COMMENT '订单合同ID',
	cancel_flag STRING COMMENT '是否有效(Y-有效,N-无效)',
	create_time STRING COMMENT '创建时间',
	update_time STRING COMMENT '更新时间'
) COMMENT '订单合同与子订单关联表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ITEM_CONTRACT_RELATION';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_AMOUNT_CHANGE (
	amount_change_id STRING COMMENT '主键',
	order_id STRING COMMENT '订单ID',
	amount DECIMAL (11) COMMENT '金额（分）',
	approve_status STRING COMMENT '审核状态',
	create_time STRING COMMENT '创建时间',
	approve_time STRING COMMENT '审核时间',
	reason STRING COMMENT '申请原因',
	amount_type STRING COMMENT '审核类型',
	memo STRING COMMENT '审核备注',
	org_id STRING COMMENT '审核组织ID',
	operator_name STRING COMMENT '操作人员',
	approve_operator STRING COMMENT '审核人员',
	object_id STRING COMMENT '对象ID',
	object_type STRING COMMENT '对象类型',
	formulas STRING COMMENT '计算规则(PLUS,SUBTRACT)',
	price_detail STRING COMMENT '线路门票使用在价格类型上(json串)',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单金额修改' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_AMOUNT_CHANGE';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ALLOCATION_RULE_ADDITIONAL (
	allocation_rule_additional_id STRING COMMENT '主键',
	ord_allocation_rule_id STRING COMMENT '分单规则ID',
	one_level_org DECIMAL (11) COMMENT '一级组织ID',
	one_level_org_name STRING COMMENT '一级组织名字',
	two_level_org DECIMAL (11) COMMENT '二级组织ID',
	two_level_orgname STRING COMMENT '二级组织名字',
	three_level_org DECIMAL (11) COMMENT '三级组织ID',
	three_level_org_name STRING COMMENT '三级组织名字',
	role_id STRING COMMENT '角色ID',
	role_name STRING COMMENT '角色名字',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '分单规则附加表' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ALLOCATION_RULE_ADDITIONAL';


CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ALLOCATION_RULE (
	ord_allocation_rule_id STRING COMMENT '订单分单规则ID',
	bu STRING COMMENT '归属BU',
	attribution_id STRING COMMENT '归属地',
	category_id STRING COMMENT '品类',
	start_district DECIMAL (11) COMMENT '出发地',
	distribution_channel STRING COMMENT '分销渠道',
	role_id STRING COMMENT '角色id',
	rule_calculate_type STRING COMMENT '规则计算类型',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '订单分单规则' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ALLOCATION_RULE';

CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ALLOCATION_LOG (
	allocation_log_id STRING COMMENT '',
	audit_id STRING COMMENT '审核对接供应商商品ID[待核实-刘源远]',
	CONTENT STRING COMMENT 'LOG内容[待核实-刘源远]',
	create_time STRING COMMENT '日志创建时间',
	log_time STRING COMMENT '日志记录时间（精确到毫秒，排序用）',
	update_time STRING COMMENT '更新时间[待核实-刘源远]'
) COMMENT '记录分单流水的日志' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ALLOCATION_LOG';

CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER (
	order_id STRING COMMENT '订单ID',
	ori_order_id STRING COMMENT '源订单ID',
	distributor_id STRING COMMENT '分销渠道ID(原分销商ID）',
	distributor_code STRING COMMENT '渠道代码，(不参与运算，由分销自己提供，识别使用)',
	order_status STRING COMMENT '订单状态',
	payment_status STRING COMMENT '支付状态',
	resource_status STRING COMMENT '资源状态',
	info_status STRING COMMENT '信息状态',
	last_cancel_time STRING COMMENT '最晚取消时间(无损取消时间)',
	wait_payment_time STRING COMMENT '支付等待时间',
	cancel_code STRING COMMENT '取消代码',
	reason STRING COMMENT '取消原因',
	currency_code STRING COMMENT '货币代码',
	ought_amount DECIMAL (11) COMMENT '应付金额',
	actual_amount DECIMAL (11) COMMENT '实付金额',
	user_id STRING COMMENT '下单人',
	user_no DECIMAL (11) COMMENT '下单人主键',
	GUARANTEE STRING COMMENT '是否需要担保',
	payment_target STRING COMMENT '支付对象（支付给驴妈妈|供应商）',
	create_time STRING COMMENT '下单时间',
	payment_type STRING COMMENT '支付方式(必须预授|可预授权|普通支付)',
	view_order_status STRING COMMENT '订单展示状态',
	invoice_status STRING COMMENT '发票状态',
	remark STRING COMMENT '游客备注',
	filiale_name STRING COMMENT '所属公司',
	payment_time STRING COMMENT '支付时间(最后一次支付操作时间)',
	back_user_id STRING COMMENT '后台下单人ID',
	approve_time STRING COMMENT '审核时间',
	visit_time STRING COMMENT '游玩入住日期',
	cancel_time STRING COMMENT '订单 取消时间',
	book_limit_type STRING COMMENT '现付预订限制,同子项',
	client_ip_address STRING COMMENT '客人下单的IP地址，只针对前台有效',
	cert_confirm_status STRING COMMENT '凭证确认状态',
	cancel_cert_confirm_status STRING COMMENT '取消凭证确认状态',
	order_memo STRING COMMENT '后台备注',
	refunded_amount DECIMAL (11) COMMENT '退款金额',
	process_key STRING COMMENT '订单流程key[待核实-刘源远]',
	distribution_channel DECIMAL (11) COMMENT '分销商ID',
	deposits_amount DECIMAL (11) COMMENT '订金金额',
	notify_type STRING COMMENT '通知类型[待核实-刘源远]',
	rebate_amount DECIMAL (28, 0) COMMENT '订单是否返现',
	rebate_flag STRING COMMENT '返现标示[待核实-刘源远]',
	bonus_amount DECIMAL (28, 0) COMMENT '奖金抵扣金额',
	need_invoice STRING COMMENT '可开发票',
	prom_payment_channel STRING COMMENT '促销支付渠道',
	category_id STRING COMMENT '品类ID[待核实-刘源远]',
	manager_id STRING COMMENT '产品经理Id[待核实-刘源远]',
	bu_code STRING COMMENT '所属BU的CODE[待核实-刘源远]',
	mobile_more_rebate DECIMAL (28, 0) COMMENT '手机端多返金额',
	remind_sms_send_status STRING COMMENT '游玩前一天提醒短信的发送状态',
	attribution_id STRING COMMENT '归属地区ID[待核实-刘源远]',
	anonymity_book_flag STRING COMMENT '是否是匿名下单，Y：是; N：否',
	cancel_fail_count DECIMAL (28, 0) COMMENT '',
	invoke_interface_pf_status STRING COMMENT '调用对接平台的状态，(INITIAL：初始化，CREATED：已调用创建供应商订单，PART_CREATED：部分子订单已调用创建供应商订单，CANCELED：已调用取消供应商订单，PART_CANCELED：部分子订单已调用取消供应商订单)',
	supplier_api_flag STRING COMMENT '是否需要调用对接平台，(Y：需要，N：不需要)',
	resource_ample_time STRING COMMENT '资源审核时间',
	info_pass_time STRING COMMENT '信息审核时间',
	valid_status STRING COMMENT '是否有效',
	company_type STRING COMMENT '公司主体',
	line_route_id STRING COMMENT '线路行程ID',
	start_district_id STRING COMMENT '出发地ID',
	mobile_equipment_no STRING COMMENT '手机设备号',
	is_test_order STRING COMMENT '是否是测试单',
	manager_id_perm STRING COMMENT '订单权限',
	distributor_name STRING COMMENT '分销商名称',
	sub_category_id STRING COMMENT '子品类ID',
	order_update_time STRING COMMENT '更新时间',
	send_contract_flag STRING COMMENT '发送合同标识',
	pay_proc_triggered STRING COMMENT '是否触发支付流程',
	cancel_strategy STRING COMMENT '退改策略',
	tag DECIMAL (11) COMMENT '标识',
	sms_lvmama_flag STRING COMMENT '短信是否只认驴妈妈标识',
	traveller_lock_flag STRING COMMENT 'Y锁定游玩人，N非锁定',
	traveller_delay_flag STRING COMMENT 'Y游玩人后置',
	stamps_amount DECIMAL (11) COMMENT '',
	order_subtype STRING COMMENT '订单子类型',
	pre_refund_status STRING COMMENT '门票订单提前退状态(APPLY:发起,COMPLETE:完成)',
	perform_status STRING COMMENT '履行状态[待核实-刘源远]',
	end_time STRING COMMENT '结束时间/离店时间',
	app_version STRING COMMENT 'App版本号',
	pay_promotion_amount DECIMAL (11) COMMENT '银行立减金额',
	ticket_last_confirm_time STRING COMMENT '门票订单最晚确认时间',
	order_creating_manner STRING COMMENT '下单方式，1 正常下单，2后台一键重下，3前台一键重下',
	distribution_cpsid STRING COMMENT 'cpsid',
	update_time STRING COMMENT '更新时间[待核实-刘源远]',
	work_version STRING COMMENT '',
	order_dfp STRING COMMENT '设备指纹',
	CONTENT STRING COMMENT '附加内容,json格式'
) COMMENT '订单' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER';

CREATE EXTERNAL TABLE
IF NOT EXISTS ODS.ODS_LVMAMA_ORD_ORD_ORDER_ITEM (
	order_item_id STRING COMMENT '订单商品ID',
	order_id STRING COMMENT '订单ID',
	category_id STRING COMMENT '品类ID',
	branch_id STRING COMMENT '规格定义ID',
	contract_id STRING COMMENT '合同ID',
	order_pack_id STRING COMMENT '主键',
	supp_goods_id STRING COMMENT '供应商商品ID',
	product_name STRING COMMENT '产品名称',
	price DECIMAL (11) COMMENT '单价',
	actual_settlement_price DECIMAL (11) COMMENT '实际结算单价',
	settlement_price DECIMAL (11) COMMENT '结算单价',
	quantity DECIMAL (11) COMMENT '数量',
	total_settlement_price DECIMAL (11) COMMENT '结算总价',
	visit_time STRING COMMENT '游玩日期|入住日期',
	need_resource_confirm STRING COMMENT '是否需要资源审核(true|false)',
	resource_status STRING COMMENT '资源状态',
	info_status STRING COMMENT '信息状态',
	market_price DECIMAL (11) COMMENT '市场价',
	perform_status STRING COMMENT '履行状态',
	perform_status_code STRING COMMENT '履行状态code',
	cancel_strategy STRING COMMENT '退改策略',
	CONTENT STRING COMMENT '附加内容,json格式',
	settlement_status STRING COMMENT '结算状态',
	main_item STRING COMMENT '主订单项(true|false)',
	product_id STRING COMMENT '产品ID',
	supp_goods_name STRING COMMENT '商品名称',
	supplier_id STRING COMMENT '供应商ID',
	deduct_type STRING COMMENT '扣款类型（退改扣款规则）',
	cert_confirm_status STRING COMMENT '凭证确认',
	cancel_cert_confirm_status STRING COMMENT '取消凭证确认状态',
	deduct_amount DECIMAL (11) COMMENT '扣款金额',
	book_limit_type STRING COMMENT '现付的担保规则(NONE|TIMEOUTGUARANTEE|ALLGUARANTEE)',
	last_cancel_time STRING COMMENT '最晚取消时间(无损取消时间)',
	order_memo STRING COMMENT '后台备注',
	ticket_type STRING COMMENT '门票类型[待核实-刘源远]',
	payment_status STRING COMMENT '支付状态[待核实-刘源远]',
	order_status STRING COMMENT '订单状态[待核实-刘源远]',
	supp_product_name STRING COMMENT '供应商产品名[待核实-刘源远]',
	total_amount DECIMAL (28, 0) COMMENT '子订单总价',
	manager_id STRING COMMENT '产品经理ID[待核实-刘源远]',
	bu_code STRING COMMENT '所属BU[待核实-刘源远]',
	attribution_id STRING COMMENT '归属地区ID[待核实-刘源远]',
	real_bu_type STRING COMMENT '',
	refund_rules STRING COMMENT '退改规则 (json 格式)',
	courier_status STRING COMMENT '快递处理状态Y|N',
	invoke_interface_pf_status STRING COMMENT '调用对接平台的状态，(INITIAL：初始化，CREATED：已调用创建供应商订单，CANCELED：已调用取消供应商订单)',
	resource_ample_time STRING COMMENT '资源审核时间',
	info_pass_time STRING COMMENT '信息审核时间',
	company_type STRING COMMENT '公司主体',
	create_time STRING COMMENT '下单时间',
	notintime_flag STRING COMMENT '是否及时通关，只用于门票（Y：不及时；N or null：及时）[待核实-刘源远]',
	buyout_price DECIMAL (11) COMMENT '买断金额',
	buyout_quantity DECIMAL (11) COMMENT '买断商品数量',
	buyout_flag STRING COMMENT '是否为买断下单',
	buyout_total_price DECIMAL (11) COMMENT '买断结算总金额',
	order_update_time STRING COMMENT '更新时间',
	stock_flag STRING COMMENT '是否保留房（Y/N）',
	order_subtype STRING COMMENT '订单子类型',
	notify_type STRING COMMENT '通知类型',
	goods_english_name STRING COMMENT '订单快照商品英文名称',
	refund_quantity DECIMAL (11) COMMENT '已退款份数[待核实-刘源远]',
	refund_price DECIMAL (11) COMMENT '退款金额[待核实-刘源远]',
	last_ahead_time STRING COMMENT '提前预定时间',
	ebk_supplier_group_id STRING COMMENT 'EBK用户所属供应商组ID',
	confirm_status STRING COMMENT '子订单确认状态',
	product_type STRING COMMENT '产品类型：国内-短线、国内-长线、出境/港澳台，存放枚举Code',
	dest_name STRING COMMENT '目的地名称',
	refund_lock_quantity DECIMAL (11) COMMENT '退款锁定份数',
	price_confirm_status STRING COMMENT '子订单价格确认状态,默认价格已确认',
	package_type STRING COMMENT '打包方式',
	update_time STRING COMMENT '更新时间[待核实-刘源远]',
	ebk_email_flag STRING COMMENT 'EBK是否支持发邮件(Y:支持；N or null:不支持)',
	supp_settlement_entity_code STRING COMMENT '结算对象编码',
	expired_refund_flag STRING COMMENT '是否过期退标识: Y-是, N-否 (默认空为N)'
) COMMENT '订单子项' PARTITIONED BY (PAR_DAY STRING) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\u0001' LOCATION '/user/hive/warehouse/ods/ODS_LVMAMA_ORD_ORD_ORDER_ITEM';